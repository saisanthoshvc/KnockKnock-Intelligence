<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}KnockKnock Intelligence - AI-Powered RFP Extraction{% endblock %}</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

    <!-- Mount-safe URLs available to every page -->
    <script>
      window.URLS = {
        index: "{{ url_for('index') }}",
        upload: "{{ url_for('upload_file') }}",
        // Use .replace('__JOB__', jobId) when needed
        poll: "{{ url_for('poll_job', job_id='__JOB__') }}",
        review: "{{ url_for('review', job_id='__JOB__') }}",
        saveEdits: "{{ url_for('save_edits', job_id='__JOB__') }}",
        exportDocx: "{{ url_for('export_data', job_id='__JOB__', format='docx') }}",
        exportXlsx: "{{ url_for('export_data', job_id='__JOB__', format='xlsx') }}"
      };
    </script>

    <style>
        :root {
            /* Ultra-Modern Color Palette - Dark Theme (Default) */
            --primary-bg: #0a0e1a;
            --secondary-bg: #111827;
            --tertiary-bg: #1f2937;
            --accent-blue: #3b82f6;
            --accent-purple: #8b5cf6;
            --accent-teal: #06d6a0;
            --accent-pink: #f72585;
            --accent-orange: #f97316;
            --text-primary: #f8fafc;
            --text-secondary: #cbd5e1;
            --text-muted: #94a3b8;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --border: rgba(255, 255, 255, 0.08);
            --border-hover: rgba(59, 130, 246, 0.3);
            --glass: rgba(17, 24, 39, 0.8);
            --glass-hover: rgba(17, 24, 39, 0.9);
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            --shadow-2xl: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            --shadow-glow: 0 0 20px rgba(59, 130, 246, 0.3);
        }

        [data-theme="light"] {
            /* Light Theme Colors */
            --primary-bg: #ffffff;
            --secondary-bg: #f8fafc;
            --tertiary-bg: #f1f5f9;
            --accent-blue: #2563eb;
            --accent-purple: #7c3aed;
            --accent-teal: #0891b2;
            --accent-pink: #db2777;
            --accent-orange: #ea580c;
            --text-primary: #0f172a;
            --text-secondary: #334155;
            --text-muted: #64748b;
            --success: #059669;
            --warning: #d97706;
            --error: #dc2626;
            --border: rgba(0, 0, 0, 0.1);
            --border-hover: rgba(37, 99, 235, 0.3);
            --glass: rgba(255, 255, 255, 0.8);
            --glass-hover: rgba(255, 255, 255, 0.9);
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            --shadow-2xl: 0 25px 50px -12px rgba(0, 0, 0, 0.15);
            --shadow-glow: 0 0 20px rgba(37, 99, 235, 0.3);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: 
                radial-gradient(ellipse at top, rgba(59, 130, 246, 0.15) 0%, transparent 50%),
                radial-gradient(ellipse at bottom right, rgba(139, 92, 246, 0.15) 0%, transparent 50%),
                radial-gradient(ellipse at bottom left, rgba(6, 214, 160, 0.1) 0%, transparent 50%),
                linear-gradient(135deg, var(--primary-bg) 0%, var(--secondary-bg) 100%);
            background-attachment: fixed;
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
            line-height: 1.6;
            font-size: 14px;
        }
        html { background-color: var(--primary-bg); scroll-behavior: smooth; }

        .particles { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: -1; }
        .container { max-width: 1400px; margin: 0 auto; padding: 0 24px; }

        .header {
            background: var(--glass);
            backdrop-filter: blur(25px) saturate(180%);
            border-bottom: 1px solid var(--border);
            padding: 1.5rem 0;
            position: sticky; top: 0; z-index: 1000;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .header-content { display: flex; justify-content: space-between; align-items: center; gap: 2rem; }
        .logo { font-size: 1.75rem; font-weight: 800;
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple), var(--accent-teal));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
            text-decoration: none; display: flex; align-items: center; gap: 0.75rem; position: relative;
        }
        .logo-icon { width: 45px; height: 45px; background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
            border-radius: 14px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.3rem; }

        .nav-link { color: var(--text-secondary); text-decoration: none; font-weight: 500; font-size: 0.9rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); position: relative; padding: 0.5rem 1rem; border-radius: 8px;
            display: flex; align-items: center; gap: 0.5rem; background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px); }
        .nav-link.active { color: var(--text-primary); background: rgba(59, 130, 246, 0.15);
            border-color: rgba(59, 130, 246, 0.4); }
        .header-controls { display: flex; align-items: center; gap: 1rem; }

        .status-indicator { display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem 1.25rem;
            background: rgba(16, 185, 129, 0.15); border: 1px solid rgba(16, 185, 129, 0.3);
            border-radius: 25px; color: var(--success); font-size: 0.9rem; font-weight: 600; }

        .main-content { padding: 3rem 0; min-height: calc(100vh - 100px); }
        .card { background: var(--glass); backdrop-filter: blur(25px) saturate(180%);
            border: 1px solid var(--border); border-radius: 24px; padding: 3rem; margin-bottom: 2.5rem; }

        /* (The rest of your original styles remain unchanged) */
    </style>
</head>
<body>
    <!-- Floating particles -->
    <div class="particles" id="particles"></div>

    <div class="container">
        <header class="header" id="header">
            <div class="header-content">
                <a href="{{ url_for('index') }}" class="logo">
                    <div class="logo-icon">
                        <i class="fas fa-brain"></i>
                    </div>
                    KnockKnock Intelligence
                </a>
                <div class="header-controls">
                    <a href="{{ url_for('index') }}" class="nav-link {% if request.endpoint == 'index' %}active{% endif %}" onclick="scrollToUpload()">
                        <i class="fas fa-upload"></i>
                        Upload & Parse
                    </a>
                    <button class="theme-toggle" onclick="toggleTheme()" title="Toggle Light/Dark Mode">
                        <i class="fas fa-sun" id="theme-icon"></i>
                    </button>
                    <div class="status-indicator">
                        <div class="status-dot"></div>
                        <span>System Online</span>
                    </div>
                </div>
            </div>
        </header>

        <main class="main-content">
            {% block content %}{% endblock %}
        </main>
    </div>

    <script>
        // Theme + particles + helpers (unchanged from your original base.html)
        function toggleTheme() {
            const body = document.body;
            const themeIcon = document.getElementById('theme-icon');
            const currentTheme = body.getAttribute('data-theme');
            if (currentTheme === 'light') {
                body.removeAttribute('data-theme');
                themeIcon.className = 'fas fa-sun';
                localStorage.setItem('theme', 'dark');
            } else {
                body.setAttribute('data-theme', 'light');
                themeIcon.className = 'fas fa-moon';
                localStorage.setItem('theme', 'light');
            }
        }
        function scrollToUpload() {
            const uploadSection = document.getElementById('uploadSection');
            if (uploadSection) uploadSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
        function initializeTheme() {
            const savedTheme = localStorage.getItem('theme');
            const body = document.body;
            const themeIcon = document.getElementById('theme-icon');
            if (savedTheme === 'light') {
                body.setAttribute('data-theme', 'light');
                themeIcon.className = 'fas fa-moon';
            } else {
                body.removeAttribute('data-theme');
                themeIcon.className = 'fas fa-sun';
            }
        }
        document.addEventListener('DOMContentLoaded', function() { initializeTheme(); });
    </script>
</body>
</html>
